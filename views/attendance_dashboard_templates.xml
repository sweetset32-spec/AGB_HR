<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <!-- Main Dashboard Template -->
    <template id="main_dashboard" name="Attendance Dashboard">
        <head>
            <title>AGB Communication - Attendance Dashboard</title>
            <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
            <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.7.2/css/all.min.css"/>    
            <link rel="stylesheet" type="text/css" href="/attendance_dashboard/static/src/css/attendance_dashboard.css"/>
            <script type="text/javascript" src="/attendance_dashboard/static/src/js/attendance_dashboard.js" defer="defer"/>
        </head>
        <body>
            <div class="agb-app-container">
                <!-- Sticky Top Navigation -->
                <div class="agb-top-nav agb-sticky-header">
                    <h1 class="agb-nav-title">Attendance Dashboard</h1>
                    <div class="agb-nav-actions flex items-center gap-2">
                        <!-- Welcome message with waving hand -->
                        <span class="agb-nav-welcome flex items-center gap-2">
                            <span>Welcome, <t t-esc="employee.name"/>!</span>
                            <span class="text-2xl animate-wave">ðŸ‘‹</span>
                        </span>      
                        <a href="/attendance/logout" class="agb-btn agb-btn-link">
                            <i class="fa fa-sign-out"></i> Logout
                        </a>
                    </div>
                </div>

                <!-- Main Content Wrapper -->
                <div class="agb-main-content-wrapper">
                    <div class="agb-dashboard-content">
                        <!-- Stats Cards -->
                        <div class="agb-stats-grid">
                            <!-- Attendance Card -->
                            <div class="agb-form-card agb-stat-card agb-stat-attendance">
                                <div class="agb-stat-icon">
                                    <i class="fa fa-check-circle"></i>
                                </div>
                                <div class="agb-stat-content">
                                    <h3>Attendance</h3>
                                    <div class="agb-stat-number"><t t-esc="stats['attendanceCount']"/></div>
                                    <p class="agb-stat-details">
                                        Present: <t t-esc="stats['attendanceCount']"/> | 
                                        <a t-attf-href="/attendance/late" class="agb-stat-link agb-stat-link-orange">Late: <t t-esc="stats['lateCount']"/></a> | 
                                        <a t-attf-href="/attendance/absent" class="agb-stat-link agb-stat-link-red">Absent: <t t-esc="stats['absentCount']"/></a>
                                    </p>
                                </div>
                                <div class="agb-stat-action">
                                    <button class="agb-btn agb-btn-link" onclick="window.location.href='/attendance/calendar'">
                                        <i class="fa fa-calendar"></i> Calendar
                                    </button>
                                </div>
                            </div>

                            <!-- Leave Card -->
                            <div class="agb-form-card agb-stat-card agb-stat-leave">
                                <div class="agb-stat-icon">
                                    <i class="fa-solid fa-file-signature"></i>
                                </div>
                                <div class="agb-stat-content">
                                    <h3>Leave</h3>
                                    <div class="agb-stat-number">0</div>
                                    <p class="agb-stat-details">Days on leave this period</p>
                                </div>
                                <div class="agb-stat-action">
                                    <button class="agb-btn agb-btn-link" onclick="showLeaveNotification()">
                                        <i class="fa fa-info-circle"></i> Details
                                    </button>
                                </div>
                            </div>
                        </div>

                        <!-- Quick Info -->
                        <div class="agb-form-card">
                            <div class="agb-quick-info">
                                <div class="agb-form-header">
                                    <i class="fa fa-info-circle"></i>
                                    <h3>Quick Information</h3>
                                </div>
                                <div class="agb-info-grid">
                                    <div class="agb-info-item">
                                        <i class="fa fa-credit-card"></i> 
                                        <span>Employee ID: <strong><t t-esc="employee.employee_number or 'Not Set'"/></strong></span>
                                    </div>
                                    <div class="agb-info-item">
                                        <i class="fa fa-building"></i> 
                                        <span>Department: <strong><t t-esc="employee.department_id.name or 'No Department'"/></strong></span>
                                    </div>
                                    <div class="agb-info-item">
                                        <i class="fa fa-briefcase"></i> 
                                        <span>Job Position: <strong><t t-esc="employee.job_title or 'No Position'"/></strong></span>
                                    </div>
                                    <div class="agb-info-item">
                                        <i class="fa fa-clock-o"></i> 
                                        <span>Working Schedule: <strong><t t-esc="', '.join(employee.resource_calendar_ids.mapped('name')) or 'Standard Schedule (9:00 AM - 6:00 PM)'"/>
</strong></span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Sticky Footer -->
                <div class="agb-footer agb-sticky-footer">
                    <p>Â© 2024 AGB Communication Myanmar. All rights reserved.</p>
                    <p>Secure Employee Portal â€¢ Attendance System v1.0</p>
                </div>
            </div>

            <!-- Notification Container -->
            <div id="notification-container" class="agb-notification-container"></div>
        </body>
    </template>

    <!-- Calendar Template -->
    <template id="attendance_calendar" name="Attendance Calendar">
        <head>
            <title>Attendance Calendar</title>
            <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
            <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css"/>    
            <link rel="stylesheet" type="text/css" href="/attendance_dashboard/static/src/css/attendance_dashboard.css"/>
            <script type="text/javascript" src="/attendance_dashboard/static/src/js/attendance_dashboard.js"/>
        </head>
        <body>
            <div class="agb-app-container">
                <!-- Sticky Top Navigation -->
                <div class="agb-top-nav agb-sticky-header">
                    <h1 class="agb-nav-title">Attendance Calendar</h1>
                    <div class="agb-nav-actions">
                        <button class="agb-btn agb-btn-link" onclick="window.location.href='/attendance/dashboard'">
                            <i class="fa fa-arrow-left"></i> Dashboard
                        </button>
                        <a href="/attendance/logout" class="agb-btn agb-btn-link">
                            <i class="fa fa-sign-out"></i> Logout
                        </a>
                    </div>
                </div>

                <!-- Main Content Wrapper -->
                <div class="agb-main-content-wrapper">
                    <div class="agb-form-card agb-calendar-container">
                        <div class="agb-calendar-navigation">
                            <button t-attf-onclick="window.location.href='/attendance/calendar?year=#{prev_month['year']}&amp;month=#{prev_month['month']}'">
                                <i class="fa fa-chevron-left"></i>
                            </button>
                            <h3><t t-esc="month_name"/> <t t-esc="year"/></h3>
                            <button t-attf-onclick="window.location.href='/attendance/calendar?year=#{next_month['year']}&amp;month=#{next_month['month']}'">
                                <i class="fa fa-chevron-right"></i>
                            </button>
                        </div>

                        <div class="agb-calendar-legend">
                            <div class="agb-legend-item">
                                <div class="agb-legend-dot agb-dot-present"></div>
                                <span>Present/Check-in/out</span>
                            </div>
                            <div class="agb-legend-item">
                                <div class="agb-legend-dot agb-dot-absent"></div>
                                <span>Absent/Missing</span>
                            </div>
                            <div class="agb-legend-item">
                                <div class="agb-legend-dot agb-dot-weekend"></div>
                                <span>Weekend</span>
                            </div>
                            <div class="agb-legend-item">
                                <div class="agb-legend-dot agb-dot-holiday"></div>
                                <span>Holiday</span>
                            </div>
                            <div class="agb-legend-item">
                                <div class="agb-legend-dot agb-dot-leave"></div>
                                <span>Leave</span>
                            </div>
                        </div>

                        <div class="agb-calendar-grid">
                            <div class="agb-calendar-header-row">
                                <div class="agb-calendar-header-cell">Sun</div>
                                <div class="agb-calendar-header-cell">Mon</div>
                                <div class="agb-calendar-header-cell">Tue</div>
                                <div class="agb-calendar-header-cell">Wed</div>
                                <div class="agb-calendar-header-cell">Thu</div>
                                <div class="agb-calendar-header-cell">Fri</div>
                                <div class="agb-calendar-header-cell">Sat</div>
                            </div>
                            <div class="agb-calendar-body">
                                <t t-set="first_day" t-value="calendar_data[1]['date'].weekday() + 1"/>
                                <t t-if="first_day == 7" t-set="first_day" t-value="0"/>
                                
                                <!-- Empty cells for days before first day -->
                                <t t-foreach="range(first_day)" t-as="empty_day">
                                    <div class="agb-calendar-day agb-calendar-day-empty"></div>
                                </t>
                                
                                <!-- Calendar days -->
                                <t t-foreach="calendar_data.items()" t-as="day_data">
                                    <t t-set="day" t-value="day_data[0]"/>
                                    <t t-set="data" t-value="day_data[1]"/>
                                    <div t-attf-class="agb-calendar-day 
                                        #{data['is_weekend'] and 'agb-calendar-weekend' or ''} 
                                        #{data['attendance_fraction'] == 1.0 and 'agb-calendar-present' or ''} 
                                        #{data['attendance_fraction'] == 0.5 and 'agb-calendar-partial' or ''} 
                                        #{data['attendance_fraction'] == 0.0 and not data['is_weekend'] and 'agb-calendar-absent' or ''} 
                                        #{data['is_today'] and 'agb-calendar-today' or ''} 
                                        #{data.get('is_future') and 'agb-calendar-future' or ''}"
                                        t-attf-data-date="#{data['formatted_date']}"
                                        t-attf-data-checkin="#{data['check_in_time'] or 'Not recorded'}"
                                        t-attf-data-checkout="#{data['check_out_time'] or 'Not recorded'}"
                                        t-attf-data-late="#{data['late_minutes'] if data['is_late'] else 0}"
                                        t-attf-data-shift="#{data['shift_name']}"
                                        t-attf-data-status="#{data['status']}"
                                        t-attf-data-attendance-fraction="#{data['attendance_fraction']}"
                                        t-attf-onclick="#{ 'showDayDetails(this)' if not data.get('is_future') else '' }">

                                        <span class="agb-day-number"><t t-esc="day"/></span>
                                        <!-- Attendance dots -->
                                        <t t-if="not data['is_weekend']">
                                            <div class="agb-attendance-dots">
                                                <!-- Check-in dot -->
                                                <div t-attf-class="agb-attendance-dot #{data['has_check_in'] and 'agb-dot-present' or 'agb-dot-absent'}"></div>
                                                <!-- Check-out dot -->
                                                <div t-attf-class="agb-attendance-dot #{data['has_check_out'] and 'agb-dot-present' or 'agb-dot-absent'}"></div>
                                            </div>
                                        </t>
                                    </div>
                                </t>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Day Details Modal -->
                <div id="day-details-modal" class="agb-day-details-modal">
                    <div class="agb-day-details-content">
                        <div class="agb-day-details-header">
                            <h3 id="modal-date">Date</h3>
                            <button class="agb-close-modal" onclick="closeDayDetails()">
                                <i class="fa fa-times"></i>
                            </button>
                        </div>
                        <div class="agb-day-details-info">
                            <div class="agb-detail-row">
                                <span class="agb-detail-label">
                                    <i class="fa fa-clock-o"></i> Shift
                                </span>
                                <span class="agb-detail-value" id="modal-shift">Standard Shift</span>
                            </div>
                            <div class="agb-detail-row">
                                <span class="agb-detail-label">
                                    <i class="fa fa-sign-in"></i> Check In
                                </span>
                                <span class="agb-detail-value" id="modal-checkin">Not recorded</span>
                            </div>
                            <div class="agb-detail-row">
                                <span class="agb-detail-label">
                                    <i class="fa fa-sign-out"></i> Check Out
                                </span>
                                <span class="agb-detail-value" id="modal-checkout">Not recorded</span>
                            </div>
                            <div class="agb-detail-row">
                                <span class="agb-detail-label">
                                    <i class="fa fa-exclamation-triangle"></i> Late Minutes
                                </span>
                                <span class="agb-detail-value" id="modal-late">0 minutes</span>
                            </div>
                            <div class="agb-detail-row">
                                <span class="agb-detail-label">
                                    <i class="fa fa-info-circle"></i> Status
                                </span>
                                <span class="agb-status-badge" id="modal-status">Present</span>
                            </div>
                            <!-- NEW ROW: Attendance Fraction -->
                            <div class="agb-detail-row">
                                <span class="agb-detail-label">
                                    <i class="fa fa-adjust"></i> Attendance
                                </span>
                                <span class="agb-detail-value" id="modal-attendance">1.0</span>
                            </div>
                        </div>

                    </div>
                </div>

                <!-- Sticky Footer -->
                <div class="agb-footer agb-sticky-footer">
                    <p>Â© 2024 AGB Communication Myanmar. All rights reserved.</p>
                    <p>Secure Employee Portal â€¢ Version 2.0</p>
                </div>
            </div>
        </body>
    </template>


    <!-- Absent Details Template -->
    <template id="absent_details" name="Absent Details">
        <head>
            <title>Absent Details</title>
            <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
            <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css"/>    
            <link rel="stylesheet" type="text/css" href="/attendance_dashboard/static/src/css/attendance_dashboard.css"/>
            <script type="text/javascript" src="/attendance_dashboard/static/src/js/attendance_dashboard.js"/>
        </head>
        <body>
            <div class="agb-app-container">
                <!-- Sticky Top Navigation -->
                <div class="agb-top-nav agb-sticky-header">
                    <h1 class="agb-nav-title">Absent Details</h1>
                    <div class="agb-nav-actions">
                       
                        <button class="agb-btn agb-btn-link" onclick="window.location.href='/attendance/dashboard'">
                            <i class="fa fa-arrow-left"></i> Dashboard
                        </button>
                        <a href="/attendance/logout" class="agb-btn agb-btn-link">
                            <i class="fa fa-sign-out"></i> Logout
                        </a>
                    </div>
                </div>

                <!-- Main Content Wrapper -->
                <div class="agb-main-content-wrapper">
                    <div class="agb-form-card agb-details-container">
                        <div class="agb-details-list">
                            <t t-foreach="absent_days" t-as="record">
                                <div class="agb-detail-card agb-absent-card">
                                    <div class="agb-detail-date">
                                        <i class="fa fa-calendar"></i>
                                        <div>
                                            <h3><t t-esc="record['formatted_date']"/></h3>
                                            <p><t t-esc="record['iso_date']"/></p>
                                        </div>
                                    </div>
                                    
                                    <div class="agb-detail-times">
                                        <div class="agb-time-item">
                                            <i class="fa fa-clock-o"></i> 
                                            <span class="agb-time-label">Check In:</span>
                                            <span class="agb-time-value">
                                                <t t-if="record.get('check_in_time')">
                                                    <span class="agb-time-display">
                                                        <t t-esc="record.get('check_in_time')"/>
                                                    </span>
                                                </t>
                                                <t t-else="">
                                                    <span class="agb-absent-indicator">
                                                        <i class="fa fa-times-circle agb-text-red"></i>
                                                        Not recorded
                                                    </span>
                                                </t>
                                            </span>
                                        </div>
                                        <div class="agb-time-item">
                                            <i class="fa fa-clock-o"></i> 
                                            <span class="agb-time-label">Check Out:</span>
                                            <span class="agb-time-value">
                                                <t t-if="record.get('check_out_time')">
                                                    <span class="agb-time-display">
                                                        <t t-esc="record.get('check_out_time')"/>
                                                    </span>
                                                </t>
                                                <t t-else="">
                                                    <span class="agb-absent-indicator">
                                                        <i class="fa fa-times-circle agb-text-red"></i>
                                                        Not recorded
                                                    </span>
                                                </t>
                                            </span>
                                        </div>
                                    </div>
                                    
                                    <div t-attf-class="agb-detail-status agb-status-absent agb-#{record['status'].replace('_', '-')}">
                                        <t t-esc="record['absence_type'].upper()"/>
                                    </div>
                                </div>
                            </t>
                        </div>

                        <t t-if="not absent_days">
                            <div class="agb-no-data">
                                <i class="fa fa-check-circle fa-4x"></i>
                                <h3>No Absent Days</h3>
                                <p>You have perfect attendance this month!</p>
                            </div>
                        </t>
                    </div>
                </div>

                <!-- Sticky Footer -->
                <div class="agb-footer agb-sticky-footer">
                    <p>Â© 2024 AGB Communication Myanmar. All rights reserved.</p>
                    <p>Secure Employee Portal â€¢ Version 2.0</p>
                </div>
            </div>
        </body>
    </template>

    <!-- Late Details Template -->
    <template id="late_details" name="Late Details">
        <head>
            <title>Late Details</title>
            <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
            <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css"/>    
            <link rel="stylesheet" type="text/css" href="/attendance_dashboard/static/src/css/attendance_dashboard.css"/>
            <script type="text/javascript" src="/attendance_dashboard/static/src/js/attendance_dashboard.js"/>
        </head>
        <body>
            <div class="agb-app-container">
                <!-- Sticky Top Navigation -->
                <div class="agb-top-nav agb-sticky-header">
                    <h1 class="agb-nav-title">Late Details</h1>
                    <div class="agb-nav-actions">
                        <button class="agb-btn agb-btn-link" onclick="window.location.href='/attendance/dashboard'">
                            <i class="fa fa-arrow-left"></i> Dashboard
                        </button>
                        <a href="/attendance/logout" class="agb-btn agb-btn-link">
                            <i class="fa fa-sign-out"></i> Logout
                        </a>
                    </div>
                </div>

                <!-- Main Content Wrapper -->
                <div class="agb-main-content-wrapper">
                    <div class="agb-form-card agb-details-container">
                        <div class="agb-details-list">
                            <t t-foreach="late_days" t-as="record">
                                <div class="agb-detail-card agb-late-card">
                                    <div class="agb-detail-date">
                                        <i class="fa fa-calendar"></i>
                                        <div>
                                            <h3><t t-esc="record['formatted_date']"/></h3>
                                            <p><t t-esc="record['iso_date']"/></p>
                                        </div>
                                    </div>
                                    
                                    <div class="agb-detail-times">
                                        <div class="agb-time-item">
                                            <i class="fa fa-clock-o"></i> 
                                            <span class="agb-time-label">Check In:</span>
                                            <span class="agb-time-value"><t t-esc="record['check_in_time']"/></span>
                                        </div>
                                        <div class="agb-late-indicator">
                                            <i class="fa fa-exclamation-triangle"></i> 
                                            <span class="agb-late-minutes"><t t-esc="record['late_minutes']"/> min late</span>
                                        </div>
                                    </div>
                                    
                                    <div t-attf-class="agb-detail-status agb-status-late agb-severity-#{record['severity']}">
                                        LATE
                                    </div>
                                </div>
                            </t>
                        </div>

                        <t t-if="not late_days">
                            <div class="agb-no-data">
                                <i class="fa fa-clock-o fa-4x"></i>
                                <h3>No Late Arrivals</h3>
                                <p>You have perfect punctuality this month!</p>
                            </div>
                        </t>
                    </div>
                </div>

                <!-- Sticky Footer -->
                <div class="agb-footer agb-sticky-footer">
                    <p>Â© 2024 AGB Communication Myanmar. All rights reserved.</p>
                    <p>Secure Employee Portal â€¢ Version 2.0</p>
                </div>
            </div>
        </body>
    </template>

    <!-- Access Denied Template -->
    <template id="access_denied" name="Access Denied">
        <head>
            <title>Access Denied</title>
            <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
            <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css"/>    
            <link rel="stylesheet" type="text/css" href="/attendance_dashboard/static/src/css/register.css"/>
        </head>
        <body>
            <div class="agb-app-container">
                <!-- Sticky Top Navigation -->
                <div class="agb-top-nav agb-sticky-header">
                    <h1 class="agb-nav-title">Access Denied</h1>
                    <div class="agb-nav-actions">
                        <a href="/employee/register" class="agb-btn agb-btn-link">
                            <i class="fa fa-sign-in"></i> Login
                        </a>
                    </div>
                </div>

                <!-- Main Content Wrapper -->
                <div class="agb-main-content-wrapper">
                    <div class="agb-form-card">
                        <div class="agb-error">
                            <i class="fa fa-exclamation-triangle fa-4x"></i>
                            <h3>Access Denied</h3>
                            <p>Please log in to access the attendance dashboard.</p>
                            <a href="/employee/register" class="agb-btn agb-btn-primary">
                                <i class="fa fa-sign-in"></i> Go to Login
                            </a>
                        </div>
                    </div>
                </div>

                <!-- Sticky Footer -->
                <div class="agb-footer agb-sticky-footer">
                    <p>Â© 2024 AGB Communication Myanmar. All rights reserved.</p>
                    <p>Secure Employee Portal â€¢ Version 2.0</p>
                </div>
            </div>
        </body>
    </template>
</odoo>